## OGCquery API User Manual(In development, not stable yet)#### OverviewThe OGCquery API retrieves capabilities XML from a given WMS/WMTS URL and provides users with the information they need to visualize map layers. The API has not implemented the GetMap API, so users must extract the necessary information from the output JSON and append it to the URL to generate maps, for examples: using CesiumJS or Leaflet.#### UsageThe API request should be made to the host URL (with Try-out API documentation: https://api.odb.ntu.edu.tw/ogcquery/) with the endpoint /capability```bashhttps://YourAPIHost/capability```The following parameters can be added to the request URL:- url: The URL of the WMS/WMTS service.- type: The type of the service (WMS or WMTS).- layer: (optional) The name of the layer to filter by.For example:```bashhttps://YourAPIHost/capability?url=https://gibs.earthdata.nasa.gov/wmts/epsg4326/best/wmts.cgi&type=WMTS&layer=*ice*```The output JSON contains the following three objects:- layers: Layer names (being filtered) retrieved from capabilities XML.- service: General information in capabilities XML.- capability: An array of objects corresponding to each layer,  containing the capabilities in each layer.To generate a map using CesiumJS or Leaflet, users must:- Determine the index of the desired layer `Selected_layer` in the output.capability array based on the layers array.- Extract the corresponding information from the output.capability[index] object.- Append the information to the URL of the service, including the GetMap/GetTile command.For example (WMTS, REST format for template URL):```bashhttps://gibs.earthdata.nasa.gov/wmts/epsg4326/best/wmts.cgi?TIME={Time}&TILEMATRIXSET={TileMatrixSet}&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}&FORMAT={format}&layer={Seleceted_layer}```#### Bounding box (bbox) and CRSThe capabilities XML contains both a bounding box and the CRS of the available layers in array of objects. For example ```//In original WMS GetCapabilities XML:BoundingBox: [{  '$CRS': 'CRS:84',  '$minx': -180,  '$miny': -90,  '$maxx': 180,  '$maxy': 90},{  '$CRS': 'EPSG:4326',  '$minx': -90,  '$miny': -180,  '$maxx': 90,  '$maxy': 180}],//OGCquery API output json:bbox: {  'CRS:84': [ -180, -90, 180, 90 ],  'EPSG:4326': [ -90, -180, 90, 180 ]},crs: [ 'CRS:84', 'EPSG:4326' ],//In original WMTS GetCapabilities XML:'ows:BoundingBox': {  '$crs': 'urn:ogc:def:crs:EPSG::3857',  'ows:LowerCorner': '-2.003750722959434E7 -1.997186888040859E7',  'ows:UpperCorner': '2.003750722959434E7 1.9971868880408563E7'},'ows:WGS84BoundingBox': {  '$crs': 'urn:ogc:def:crs:OGC:2:84',  'ows:LowerCorner': '-179.99999000000003 -85.00000000000003',  'ows:UpperCorner': '179.99999000000003 85.0'},//OGCquery API output json: bbox: {  'CRS:84': [ -179.99999000000003, -85.00000000000003, 179.99999000000003, 85 ],  'EPSG:3857': [    -20037507.22959434,    -19971868.88040859,    20037507.22959434,    19971868.880408563]},crs: [ 'CRS:84', 'EPSG:3857' ],```#### DimensionTime, elevation, and other dimensions included in capabilities XML```capability:[  { //...  dimension:{    time:{      value: '', //in WMS, it's #text      default: '',      unit: '',      // //extra `Dimension` properties is stored as is in original XML    },//...  },}, //{...}]}```#### Style and legendThe `style` property (for a WMS/WMTS layer) provides details about the name and legend of the style. If a default style is available, its name will be stored in the `default` property. If no default style is available, the `example` property will contain the name of one of the available styles. If there is no default style, the `legend` property will be associated with the example style.In addition, the `legend` property contains an array of objects for LegendURL in XML with information about the URL for the legend image, as well as its width, height, and format. Note that the format of the `LegendURL` can vary greatly between different WMS and WMTS services. Therefore, extra `LegendURL` properties is stored as is, and it is up to the user to parse its contents. If you need to use the `LegendURL` property, be sure to check whether a default or example style is available before accessing it. Here's an example of the `capability` object:```jscapability:[  {    style: {      default: "Default style name",      example: "Other style name",  //if no default style, i.e. mutually exclusive with the key 'default'      legend: [ {          link: '',          type: '', //more likely to be 'simple',          format: '',          width:,           height:,          //extra `LegendURL` properties is stored as is        } ]    },    //...  }, //  {...}, ]```#### TileMatrixSetNote: `TileMatrixSet` object is under the `service` object.```js{  service: {    TileMatrixSet: {      "Each TileMatrixID": ["Each TileMatrix Item", ] //i.e. Each TileMatrixID is the key and its value is array of TileMatrix items in this TileMatrixID    }  }}```#### Version history- v0.1.4 (202303): Added information about the bounding box (bbox) and CRS problem.- v0.1.6 (202304): Added default style- v0.1.7 (202304): Added dimension and legend- v0.1.8 (202304): Added TileMatrixSet object